# ADR-0002: Roadmap de Implementación del Kit

Estado: Propuesto

Contexto
- El kit ya cuenta con hardening inicial (flags, idempotencia, hooks seguros, secret scan, tests/CI básicos).
- Persisten riesgos de mantenibilidad (heredocs extensos), cobertura de tests limitada y CI mejorable.

Decisión
1. Modularizar plantillas
- Extraer prompts/agents/hooks/CLAUDE a `templates/` y renderizar en init con placeholders.
- Beneficios: diffs claros, reuso por tipo, menor riesgo de quoting.

2. Fortalecer pruebas
- Añadir bats-core para funciones de parseo/validación.
- Mantener tests de integración/flags y `healthcheck.sh` por tipo.

3. Endurecer CI/CD
- `permissions: contents: read`, `concurrency` por ref, acciones pin por SHA.
- Checks requeridos: lint, tests init/flags, unit, secret scan.

4. Seguridad por diseño
- Hooks con `lint --fix` y notificaciones opt‑in (por env) — ya aplicado y se mantiene.
- `.env.example` por tipo; PHI policy y `check-phi.sh` en “medical”.

5. Releases reproducibles
- `VERSION` + `scripts/release.sh` (SemVer, changelog desde Conventional Commits, checksum del script).

Implicaciones
- Cambios en init para leer desde `templates/` y sustituir placeholders.
- Necesidad de mantener plantillas por tipo en sincronía con `CLAUDE.md`.

Alternativas consideradas
- Mantener heredocs en un solo archivo (descartado por mantenibilidad).
- Migrar a un generador en Node (descartado por dependencia extra).

Plan de Migración
- Fase 1: Crear `templates/` y portar comandos/agents más usados.
- Fase 2: Portar hooks y `CLAUDE.md` por tipo con pruebas de snapshot.
- Fase 3: Limpiar heredocs remanentes y documentar proceso de contribución.

Criterios de Aceptación
- `claude-project-init.sh --dry-run` muestra plan correcto por tipo.
- Tests (unit/integración/flags) y secret scan verdes en CI endurecido.
- `healthcheck.sh` pasa en proyectos generados de todos los tipos.

