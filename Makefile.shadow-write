# Makefile para Shadow Write + MÃ©tricas TaskDB
# Uso: make baseline

.PHONY: baseline shadow-on metrics baseline-report

baseline: shadow-on metrics baseline-report

shadow-on:
	@echo "ğŸ”„ Activando shadow write..."
	npm run taskdb:shadow:on

metrics:
	@echo "ğŸ“Š Iniciando exportador de mÃ©tricas..."
	npm run taskdb:metrics &
	@sleep 2

baseline-report:
	@echo "ğŸ“‹ Generando baseline report..."
	npm run taskdb:baseline
	@echo "âœ… Baseline generado en reports/TASKDB-BASELINE.md"

test-metrics:
	@echo "ğŸ§ª Probando endpoint de mÃ©tricas..."
	@curl -s http://localhost:9464/metrics | head -n 20

clean:
	@echo "ğŸ§¹ Limpiando procesos de mÃ©tricas..."
	@pkill -f "metrics/exporter.mjs" || true
