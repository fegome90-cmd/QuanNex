prp:
  id: prp-rag-0001
  name: "RAG: Ingesta + Retrieval + Eval"
  created_at: "2025-10-03"
  owner: "equipo-rag@tudominio"

tools:
  embeddings:
    provider: openai
    # ✅ rango semántico, no pin duro
    version_range: "text-embedding-3-*: ^2025.09"
    embedding_dim: 1536
  llm:
    provider: openai
    version_range: "gpt-4o-mini: ^2025.08"
    temperature: 0.1
    max_tokens: 800
  retriever:
    type: qdrant
    collection: rag_demo
    top_k: 8
    score_threshold: 0.70
    filter:
      model_id: "text-embedding-3-*"

evidence:
  pin_policy:
    default: relaxed      # relaxed | strict | ttl
    critical_paths:
      - pattern: "docs/adr/**"
        policy: strict
      - pattern: "policies/**"
        policy: ttl
        ttl_days: 60

  # ✅ pines soportan 3 modos: relaxed (sin hash), ttl, strict (con hash)
  chunks_pinned:
    - id: "rag:docs/adr/ADR-002.md:0"
      uri: "docs/adr/ADR-002.md"
      idx: 0
      hash: "9f2ea1d...c1"     # usado sólo si policy=strict
      policy: strict
    - id: "rag:docs/rag/README_RAG.md:2"
      uri: "docs/rag/README_RAG.md"
      idx: 2
      policy: relaxed

lifecycle:
  # quién y cuándo actualiza los locks
  maintainers:
    - "arquitectura@tudominio"
    - "conocimiento@tudominio"
  review_interval_days: 90
  auto_update:
    enable: true
    # generará PR automatizado si sólo cambian hashes en relaxed/ttl
    allowed_changes: ["hash_relaxed", "hash_ttl"]

quality_gates:
  ragas:
    faithfulness: ">=0.70"
    answer_relevancy: ">=0.70"
    context_recall: ">=0.65"
  alerts:
    gate_fail_rate_5m: "<=0.05"
    score_distribution_p50: ">=0.78"
