{
  "timestamp": "2025-10-02T17:25:25.503Z",
  "test_name": "GAP-004 Agent Authentication Test",
  "results": [
    {
      "agent": "agents/context/agent.js",
      "tests": [
        {
          "name": "Comunicación sin autenticación",
          "expected": "unauthenticated",
          "actual": "unauthenticated",
          "security_risk": "high",
          "authenticated": false,
          "output": "🚫 [Rate Limiter] context: Rate limit exceeded (10/10)\n{\n  \"schema_version\": \"1.0.0\",\n  \"agent_version\": \"1.0.0\",\n  \"error\": [\n    \"Rate limit exceeded for context agent. Please retry in 1 minute.\"\n  ],\n  \"rate_limit_info\": {\n    \"agent\": \"context\",\n    \"retry_after_seconds\": 60\n  }\n}\n",
          "passed": true
        },
        {
          "name": "Comunicación con datos sensibles",
          "expected": "authenticated",
          "actual": "unauthenticated",
          "security_risk": "critical",
          "authenticated": false,
          "output": "🚫 [Rate Limiter] context: Rate limit exceeded (10/10)\n{\n  \"schema_version\": \"1.0.0\",\n  \"agent_version\": \"1.0.0\",\n  \"error\": [\n    \"Rate limit exceeded for context agent. Please retry in 1 minute.\"\n  ],\n  \"rate_limit_info\": {\n    \"agent\": \"context\",\n    \"retry_after_seconds\": 60\n  }\n}\n",
          "passed": false
        },
        {
          "name": "Comunicación entre agentes",
          "expected": "authenticated",
          "actual": "unauthenticated",
          "security_risk": "high",
          "authenticated": false,
          "output": "🚫 [Rate Limiter] context: Rate limit exceeded (10/10)\n{\n  \"schema_version\": \"1.0.0\",\n  \"agent_version\": \"1.0.0\",\n  \"error\": [\n    \"Rate limit exceeded for context agent. Please retry in 1 minute.\"\n  ],\n  \"rate_limit_info\": {\n    \"agent\": \"context\",\n    \"retry_after_seconds\": 60\n  }\n}\n",
          "passed": false
        }
      ],
      "overall": "fail",
      "communication_patterns": [
        {
          "type": "spawn_sync",
          "security_level": "medium",
          "match": "spawnSync(",
          "authenticated": false
        },
        {
          "type": "json_parse",
          "security_level": "medium",
          "match": "JSON.parse",
          "authenticated": false
        },
        {
          "type": "json_parse",
          "security_level": "medium",
          "match": "JSON.parse",
          "authenticated": false
        },
        {
          "type": "json_stringify",
          "security_level": "medium",
          "match": "JSON.stringify",
          "authenticated": false
        },
        {
          "type": "json_stringify",
          "security_level": "medium",
          "match": "JSON.stringify",
          "authenticated": false
        }
      ],
      "auth_patterns": [
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        }
      ],
      "score": "1/3"
    },
    {
      "agent": "agents/prompting/agent.js",
      "tests": [
        {
          "name": "Comunicación sin autenticación",
          "expected": "unauthenticated",
          "actual": "unauthenticated",
          "security_risk": "high",
          "authenticated": false,
          "output": "node:internal/modules/esm/resolve:274\n    throw new ERR_MODULE_NOT_FOUND(\n          ^\n\nError [ERR_MODULE_NOT_FOUND]: Cannot find module '/Users/felipe/Developer/startkit-main/agents/utils/log-sanitizer.js' imported from /Users/felipe/Developer/startkit-main/agents/prompting/agent.js\n    at finalizeResolution (node:internal/modules/esm/resolve:274:11)\n    at moduleResolve (node:internal/modules/esm/resolve:864:10)\n    at defaultResolve (node:internal/modules/esm/resolve:990:11)\n    at #cachedDefa",
          "passed": true
        },
        {
          "name": "Comunicación con datos sensibles",
          "expected": "authenticated",
          "actual": "unauthenticated",
          "security_risk": "critical",
          "authenticated": false,
          "output": "node:internal/modules/esm/resolve:274\n    throw new ERR_MODULE_NOT_FOUND(\n          ^\n\nError [ERR_MODULE_NOT_FOUND]: Cannot find module '/Users/felipe/Developer/startkit-main/agents/utils/log-sanitizer.js' imported from /Users/felipe/Developer/startkit-main/agents/prompting/agent.js\n    at finalizeResolution (node:internal/modules/esm/resolve:274:11)\n    at moduleResolve (node:internal/modules/esm/resolve:864:10)\n    at defaultResolve (node:internal/modules/esm/resolve:990:11)\n    at #cachedDefa",
          "passed": false
        },
        {
          "name": "Comunicación entre agentes",
          "expected": "authenticated",
          "actual": "unauthenticated",
          "security_risk": "high",
          "authenticated": false,
          "output": "node:internal/modules/esm/resolve:274\n    throw new ERR_MODULE_NOT_FOUND(\n          ^\n\nError [ERR_MODULE_NOT_FOUND]: Cannot find module '/Users/felipe/Developer/startkit-main/agents/utils/log-sanitizer.js' imported from /Users/felipe/Developer/startkit-main/agents/prompting/agent.js\n    at finalizeResolution (node:internal/modules/esm/resolve:274:11)\n    at moduleResolve (node:internal/modules/esm/resolve:864:10)\n    at defaultResolve (node:internal/modules/esm/resolve:990:11)\n    at #cachedDefa",
          "passed": false
        }
      ],
      "overall": "fail",
      "communication_patterns": [
        {
          "type": "spawn_sync",
          "security_level": "medium",
          "match": "spawnSync(",
          "authenticated": false
        },
        {
          "type": "json_parse",
          "security_level": "medium",
          "match": "JSON.parse",
          "authenticated": false
        },
        {
          "type": "json_parse",
          "security_level": "medium",
          "match": "JSON.parse",
          "authenticated": false
        },
        {
          "type": "json_stringify",
          "security_level": "medium",
          "match": "JSON.stringify",
          "authenticated": false
        }
      ],
      "auth_patterns": [
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        }
      ],
      "score": "1/3"
    },
    {
      "agent": "agents/rules/agent.js",
      "tests": [
        {
          "name": "Comunicación sin autenticación",
          "expected": "unauthenticated",
          "actual": "unauthenticated",
          "security_risk": "high",
          "authenticated": false,
          "output": "node:internal/modules/esm/resolve:274\n    throw new ERR_MODULE_NOT_FOUND(\n          ^\n\nError [ERR_MODULE_NOT_FOUND]: Cannot find module '/Users/felipe/Developer/startkit-main/agents/utils/log-sanitizer.js' imported from /Users/felipe/Developer/startkit-main/agents/rules/agent.js\n    at finalizeResolution (node:internal/modules/esm/resolve:274:11)\n    at moduleResolve (node:internal/modules/esm/resolve:864:10)\n    at defaultResolve (node:internal/modules/esm/resolve:990:11)\n    at #cachedDefaultR",
          "passed": true
        },
        {
          "name": "Comunicación con datos sensibles",
          "expected": "authenticated",
          "actual": "unauthenticated",
          "security_risk": "critical",
          "authenticated": false,
          "output": "node:internal/modules/esm/resolve:274\n    throw new ERR_MODULE_NOT_FOUND(\n          ^\n\nError [ERR_MODULE_NOT_FOUND]: Cannot find module '/Users/felipe/Developer/startkit-main/agents/utils/log-sanitizer.js' imported from /Users/felipe/Developer/startkit-main/agents/rules/agent.js\n    at finalizeResolution (node:internal/modules/esm/resolve:274:11)\n    at moduleResolve (node:internal/modules/esm/resolve:864:10)\n    at defaultResolve (node:internal/modules/esm/resolve:990:11)\n    at #cachedDefaultR",
          "passed": false
        },
        {
          "name": "Comunicación entre agentes",
          "expected": "authenticated",
          "actual": "unauthenticated",
          "security_risk": "high",
          "authenticated": false,
          "output": "node:internal/modules/esm/resolve:274\n    throw new ERR_MODULE_NOT_FOUND(\n          ^\n\nError [ERR_MODULE_NOT_FOUND]: Cannot find module '/Users/felipe/Developer/startkit-main/agents/utils/log-sanitizer.js' imported from /Users/felipe/Developer/startkit-main/agents/rules/agent.js\n    at finalizeResolution (node:internal/modules/esm/resolve:274:11)\n    at moduleResolve (node:internal/modules/esm/resolve:864:10)\n    at defaultResolve (node:internal/modules/esm/resolve:990:11)\n    at #cachedDefaultR",
          "passed": false
        }
      ],
      "overall": "fail",
      "communication_patterns": [
        {
          "type": "spawn_sync",
          "security_level": "medium",
          "match": "spawnSync(",
          "authenticated": false
        },
        {
          "type": "json_parse",
          "security_level": "medium",
          "match": "JSON.parse",
          "authenticated": false
        },
        {
          "type": "json_parse",
          "security_level": "medium",
          "match": "JSON.parse",
          "authenticated": false
        },
        {
          "type": "json_stringify",
          "security_level": "medium",
          "match": "JSON.stringify",
          "authenticated": false
        }
      ],
      "auth_patterns": [
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        }
      ],
      "score": "1/3"
    },
    {
      "agent": "agents/security/agent.js",
      "tests": [
        {
          "name": "Comunicación sin autenticación",
          "expected": "unauthenticated",
          "actual": "unauthenticated",
          "security_risk": "high",
          "authenticated": false,
          "output": "node:internal/modules/esm/resolve:274\n    throw new ERR_MODULE_NOT_FOUND(\n          ^\n\nError [ERR_MODULE_NOT_FOUND]: Cannot find module '/Users/felipe/Developer/startkit-main/agents/utils/file-rate-limiter.js' imported from /Users/felipe/Developer/startkit-main/agents/security/agent.js\n    at finalizeResolution (node:internal/modules/esm/resolve:274:11)\n    at moduleResolve (node:internal/modules/esm/resolve:864:10)\n    at defaultResolve (node:internal/modules/esm/resolve:990:11)\n    at #cachedD",
          "passed": true
        },
        {
          "name": "Comunicación con datos sensibles",
          "expected": "authenticated",
          "actual": "unauthenticated",
          "security_risk": "critical",
          "authenticated": false,
          "output": "node:internal/modules/esm/resolve:274\n    throw new ERR_MODULE_NOT_FOUND(\n          ^\n\nError [ERR_MODULE_NOT_FOUND]: Cannot find module '/Users/felipe/Developer/startkit-main/agents/utils/file-rate-limiter.js' imported from /Users/felipe/Developer/startkit-main/agents/security/agent.js\n    at finalizeResolution (node:internal/modules/esm/resolve:274:11)\n    at moduleResolve (node:internal/modules/esm/resolve:864:10)\n    at defaultResolve (node:internal/modules/esm/resolve:990:11)\n    at #cachedD",
          "passed": false
        },
        {
          "name": "Comunicación entre agentes",
          "expected": "authenticated",
          "actual": "unauthenticated",
          "security_risk": "high",
          "authenticated": false,
          "output": "node:internal/modules/esm/resolve:274\n    throw new ERR_MODULE_NOT_FOUND(\n          ^\n\nError [ERR_MODULE_NOT_FOUND]: Cannot find module '/Users/felipe/Developer/startkit-main/agents/utils/file-rate-limiter.js' imported from /Users/felipe/Developer/startkit-main/agents/security/agent.js\n    at finalizeResolution (node:internal/modules/esm/resolve:274:11)\n    at moduleResolve (node:internal/modules/esm/resolve:864:10)\n    at defaultResolve (node:internal/modules/esm/resolve:990:11)\n    at #cachedD",
          "passed": false
        }
      ],
      "overall": "fail",
      "communication_patterns": [
        {
          "type": "spawn_sync",
          "security_level": "medium",
          "match": "spawnSync(",
          "authenticated": false
        },
        {
          "type": "stdin",
          "security_level": "medium",
          "match": "process.stdin",
          "authenticated": false
        },
        {
          "type": "stdin",
          "security_level": "medium",
          "match": "process.stdin",
          "authenticated": false
        },
        {
          "type": "stdin",
          "security_level": "medium",
          "match": "process.stdin",
          "authenticated": false
        },
        {
          "type": "json_parse",
          "security_level": "medium",
          "match": "JSON.parse",
          "authenticated": false
        },
        {
          "type": "json_parse",
          "security_level": "medium",
          "match": "JSON.parse",
          "authenticated": false
        },
        {
          "type": "json_stringify",
          "security_level": "medium",
          "match": "JSON.stringify",
          "authenticated": false
        },
        {
          "type": "json_stringify",
          "security_level": "medium",
          "match": "JSON.stringify",
          "authenticated": false
        },
        {
          "type": "json_stringify",
          "security_level": "medium",
          "match": "JSON.stringify",
          "authenticated": false
        }
      ],
      "auth_patterns": [
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "token_reference",
          "security_level": "high",
          "match": "token",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "auth_reference",
          "security_level": "high",
          "match": "auth",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        },
        {
          "type": "validate",
          "security_level": "medium",
          "match": "validate",
          "implemented": true
        }
      ],
      "score": "1/3"
    }
  ],
  "overall_passed": false,
  "summary": {
    "total_agents": 4,
    "total_tests": 12,
    "passed_tests": 4,
    "total_communication_patterns": 22,
    "total_auth_patterns": 52,
    "unauthenticated_communications": 22
  }
}