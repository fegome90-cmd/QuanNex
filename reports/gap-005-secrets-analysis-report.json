{
  "timestamp": "2025-10-02T17:25:25.504Z",
  "test_name": "GAP-005 Secrets Management Analysis",
  "results": {
    "files_analyzed": 12,
    "total_hardcoded_secrets": 35,
    "total_secure_patterns": 17,
    "total_risk_score": 325,
    "total_secure_score": 34,
    "findings": [
      {
        "file": "utils/jwt-auth.js",
        "hardcoded_secrets": [
          {
            "type": "hardcoded_secret",
            "severity": "critical",
            "match": "secret = await",
            "line": 148
          },
          {
            "type": "hardcoded_secret",
            "severity": "critical",
            "match": "secret = await",
            "line": 148
          },
          {
            "type": "hardcoded_key",
            "severity": "critical",
            "match": "Key = await",
            "line": 49
          },
          {
            "type": "hardcoded_key",
            "severity": "critical",
            "match": "Key = await",
            "line": 49
          },
          {
            "type": "hardcoded_password",
            "severity": "critical",
            "match": "password: details.password",
            "line": 294
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token: details.token",
            "line": 293
          },
          {
            "type": "public_key",
            "severity": "high",
            "match": "publicKey = await",
            "line": 55
          }
        ],
        "secure_patterns": [],
        "risk_score": 65,
        "secure_score": 0
      },
      {
        "file": "utils/agent-auth-middleware.js",
        "hardcoded_secrets": [
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token = authHeader?.replace('",
            "line": 16
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token = generateAgentToken(agentId,",
            "line": 75
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token = generateAgentToken(agentId,",
            "line": 75
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token: token,",
            "line": 105
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token = generateAgentToken(agentId,",
            "line": 75
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token: token,",
            "line": 105
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token = generateAgentToken(sourceAgent,",
            "line": 153
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token: token,",
            "line": 105
          }
        ],
        "secure_patterns": [],
        "risk_score": 80,
        "secure_score": 0
      },
      {
        "file": "utils/log-sanitizer.js",
        "hardcoded_secrets": [
          {
            "type": "hardcoded_secret",
            "severity": "critical",
            "match": "secret=***'",
            "line": 12
          },
          {
            "type": "hardcoded_key",
            "severity": "critical",
            "match": "key=***'",
            "line": 11
          },
          {
            "type": "hardcoded_key",
            "severity": "critical",
            "match": "key=***'",
            "line": 11
          },
          {
            "type": "hardcoded_key",
            "severity": "critical",
            "match": "Key = sanitizeString(key);",
            "line": 67
          },
          {
            "type": "hardcoded_password",
            "severity": "critical",
            "match": "password=***'",
            "line": 9
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token=***'",
            "line": 10
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token=***'",
            "line": 10
          },
          {
            "type": "hardcoded_api_key",
            "severity": "critical",
            "match": "api-key=***'",
            "line": 27
          }
        ],
        "secure_patterns": [],
        "risk_score": 80,
        "secure_score": 0
      },
      {
        "file": "utils/file-rate-limiter.js",
        "hardcoded_secrets": [],
        "secure_patterns": [],
        "risk_score": 0,
        "secure_score": 0
      },
      {
        "file": "agents/context/agent.js",
        "hardcoded_secrets": [],
        "secure_patterns": [],
        "risk_score": 0,
        "secure_score": 0
      },
      {
        "file": "agents/security/agent.js",
        "hardcoded_secrets": [],
        "secure_patterns": [],
        "risk_score": 0,
        "secure_score": 0
      },
      {
        "file": "agents/prompting/agent.js",
        "hardcoded_secrets": [],
        "secure_patterns": [],
        "risk_score": 0,
        "secure_score": 0
      },
      {
        "file": "agents/rules/agent.js",
        "hardcoded_secrets": [],
        "secure_patterns": [],
        "risk_score": 0,
        "secure_score": 0
      },
      {
        "file": "orchestration/orchestrator.js",
        "hardcoded_secrets": [
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "Token = process.env.MCP_AGENT_AUTH_TOKEN",
            "line": 595
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "TOKEN: agentToken",
            "line": 609
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "token = agentToken;",
            "line": 679
          },
          {
            "type": "env_hardcoded",
            "severity": "high",
            "match": "process.env.FEATURE_ROUTER_V2 === '1',\n      fsmV2: process.env.FEATURE_FSM_V2 === '",
            "line": 65
          },
          {
            "type": "env_hardcoded",
            "severity": "high",
            "match": "process.env.FEATURE_CANARY === '1',\n      monitoring: process.env.FEATURE_MONITORING === '",
            "line": 67
          },
          {
            "type": "env_hardcoded",
            "severity": "high",
            "match": "process.env.FEATURE_CONTEXT_V2 === '1',\n      handoffs: process.env.FEATURE_HANDOFF === '",
            "line": 69
          }
        ],
        "secure_patterns": [
          {
            "type": "env_variable",
            "security_level": "good",
            "match": "process.env.FEATURE_ROUTER_V",
            "line": 65
          },
          {
            "type": "env_variable",
            "security_level": "good",
            "match": "process.env.FEATURE_FSM_V",
            "line": 66
          },
          {
            "type": "env_variable",
            "security_level": "good",
            "match": "process.env.FEATURE_CANARY",
            "line": 67
          },
          {
            "type": "env_variable",
            "security_level": "good",
            "match": "process.env.FEATURE_MONITORING",
            "line": 68
          },
          {
            "type": "env_variable",
            "security_level": "good",
            "match": "process.env.FEATURE_CONTEXT_V",
            "line": 69
          },
          {
            "type": "env_variable",
            "security_level": "good",
            "match": "process.env.FEATURE_HANDOFF",
            "line": 70
          },
          {
            "type": "env_variable",
            "security_level": "good",
            "match": "process.env.MCP_AGENT_AUTH_TOKEN",
            "line": 595
          },
          {
            "type": "env_file",
            "security_level": "good",
            "match": ".env",
            "line": 65
          },
          {
            "type": "env_file",
            "security_level": "good",
            "match": ".env",
            "line": 65
          },
          {
            "type": "env_file",
            "security_level": "good",
            "match": ".env",
            "line": 65
          },
          {
            "type": "env_file",
            "security_level": "good",
            "match": ".env",
            "line": 65
          },
          {
            "type": "env_file",
            "security_level": "good",
            "match": ".env",
            "line": 65
          },
          {
            "type": "env_file",
            "security_level": "good",
            "match": ".env",
            "line": 65
          },
          {
            "type": "env_file",
            "security_level": "good",
            "match": ".env",
            "line": 65
          },
          {
            "type": "env_file",
            "security_level": "good",
            "match": ".env",
            "line": 65
          },
          {
            "type": "env_file",
            "security_level": "good",
            "match": ".env",
            "line": 65
          },
          {
            "type": "random_bytes",
            "security_level": "good",
            "match": "crypto.randomBytes",
            "line": 49
          }
        ],
        "risk_score": 45,
        "secure_score": 34
      },
      {
        "file": "package.json",
        "hardcoded_secrets": [
          {
            "type": "url_with_credentials",
            "severity": "critical",
            "match": "https://github.com/fegome90-cmd/startkit.git\"\n  },\n  \"engines\": {\n    \"node\": \">=20.10.0\"\n  },\n  \"devDependencies\": {\n    \"@",
            "line": 145
          }
        ],
        "secure_patterns": [],
        "risk_score": 10,
        "secure_score": 0
      },
      {
        "file": ".env",
        "hardcoded_secrets": [
          {
            "type": "hardcoded_secret",
            "severity": "critical",
            "match": "SECRET=${RATE_LIMIT_SECRET}",
            "line": 12
          },
          {
            "type": "hardcoded_key",
            "severity": "critical",
            "match": "KEY=${JWT_SECRET_KEY}",
            "line": 5
          },
          {
            "type": "hardcoded_key",
            "severity": "critical",
            "match": "KEY=${JWT_PUBLIC_KEY}",
            "line": 6
          },
          {
            "type": "hardcoded_token",
            "severity": "critical",
            "match": "TOKEN=${MCP_AGENT_AUTH_TOKEN}",
            "line": 9
          },
          {
            "type": "public_key",
            "severity": "high",
            "match": "PUBLIC_KEY=${JWT_PUBLIC_KEY}",
            "line": 6
          }
        ],
        "secure_patterns": [],
        "risk_score": 45,
        "secure_score": 0
      },
      {
        "file": ".env.example",
        "hardcoded_secrets": [],
        "secure_patterns": [],
        "risk_score": 0,
        "secure_score": 0,
        "error": "ENOENT: no such file or directory, open '.env.example'"
      }
    ]
  },
  "report": {
    "overall_status": "poor",
    "needs_improvement": true
  },
  "summary": {
    "files_analyzed": 12,
    "total_hardcoded_secrets": 35,
    "total_secure_patterns": 17,
    "total_risk_score": 325,
    "total_secure_score": 34,
    "overall_status": "poor",
    "needs_improvement": true
  }
}